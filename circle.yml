dependencies:
  override:
    - wget -O php7.2.tar.gz https://jenkins.pmmp.io/job/PHP-7.2-Aggregate/lastSuccessfulBuild/artifact/PHP-7.2-Linux-x86_64.tar.gz --no-check-certificate
    - tar -xvf php7.2.tar.gz
    - bin/php7/bin/php bin/composer install

test:
  post:
    - git submodule sync
    - git submodule update --init
    - rm -rf plugins
    - rm -rf bin
    - rm -rf artifacts
    - mkdir plugins
    - mkdir artifacts
    - wget https://github.com/pmmp/PocketMine-DevTools/archive/master.zip
    - unzip master.zip
    - cp -r PocketMine-DevTools-master/ plugins/
    - bin/php7/bin/php ci.php
    - cp -R plugins/DevTools/* $CIRCLE_ARTIFACTS
